{{! ================================================================================================================= }}
{{! W I D G E T   -   A D V E R T I S E M E N T                                                                       }}
{{! ================================================================================================================= }}

{{!
// TODO: Fix anotations.
}}

{{!
 * @param {Object}          widgetConfig
 * @param {string}          widgetConfig.link
 * @param {Object}          widgetConfig.utm
 * @param {Object}          widgetConfig.logo
 * @param {string}          widgetConfig.logo.name
 * @param {string}          widgetConfig.logo.color
 * @param {string}          widgetConfig.title
 * @param {number}          widgetConfig.titleResponsiveSize
 * @param {string}          widgetConfig.image
 * @param {string}          widgetConfig.imageAlt
 * @param {Object}          widgetConfig.background
 * @param {string}          widgetConfig.background.image
 * @param {string}          widgetConfig.background.bgColor
 * @param {number}          widgetConfig.background.width
 * @param {number}          widgetConfig.background.height
 * @param {string}          widgetConfig.background.cssSize
 * @param {Object[]}        widgetConfig.contentOrder
 * @param {string}          widgetConfig.contentOrder[].type
 * @param {string[]|Object} widgetConfig.contentOrder[].config
 * @param {string}          widgetClass
}}

{{assign "adLink" (concat widgetConfig.link (utmVariables widgetConfig.utm))}}
{{assign "adClasses" (classList "widget" "w-advertisement" widgetClass "set-max-width")}}

{{! ================================================================================================================= }}

{{#table class=(classList "widget" "w-advertisement" widgetClass "set-max-width")}}

  {{#and widgetConfig.background widgetConfig.background.image}}
    <tr>
      {{>ui-background backgroundBehavior="cell" backgroundStart=true
        bgImage=widgetConfig.background.image
        bgColor=widgetConfig.background.bgColor
        bgWidth=widgetConfig.background.width
        bgHeight=widgetConfig.background.height
        bgSize=widgetConfig.background.cssSize
      }}
        <table {{{tableAttr}}}>
  {{/and}}

  {{#if widgetConfig.logo}}
    <tr>
      {{!
      // TODO: Add modifier classes base on which logo is seleceted.
      }}
      <td class="justia-logo" responsive="mobile-padding-horizontal-sides">
        <a href="{{{@root.adLink}}}" target="_blank">
          {{>img
            src=(get (concat (camelcase widgetConfig.logo.name) ".path." widgetConfig.logo.color) logos)
            alt=(get (concat (camelcase widgetConfig.logo.name) ".alt") logos)
          }}
        </a>
      </td>
    </tr>
  {{/if}}

  {{#if widgetConfig.title}}
    <tr>
      <td class="title" responsive="mobile-padding-horizontal-sides">
        <a href="{{{@root.adLink}}}" target="_blank" responsive="mobile-fz-{{default widgetConfig.titleResponsiveSize "24"}}">
          {{{widgetConfig.title}}}
        </a>
      </td>
    </tr>
  {{/if}}

  {{#if widgetConfig.image}}
    <tr>
      <td class="image">
        <a href="{{{@root.adLink}}}" target="_blank">
          {{>img
            src=widgetConfig.image
            alt=(default widgetConfig.title widgetConfig.imageAlt)
          }}
        </a>
      </td>
    </tr>
  {{/if}}
        {{#if widgetConfig.contentOrder}}
          {{#forEach widgetConfig.contentOrder}}

  <tr>
    <td class="content-wrapper" responsive="mobile-padding-horizontal-sides">
      {{#table}}

            {{#compare this.type "===" "intro"}}
              <tr>
                <td class="content -intro -idx-{{index}}{{#if isFirst}} -first{{/if}}{{#if isLast}} -last{{/if}}" responsive="mobile-padding-horizontal-sides">
                  <p class="title" responsive="mobile-padding-horizontal-sides mobile-fz-31"><strong>Website Report</strong></p>
                  <p class="date">{{{../widgetConfig.month}}}, {{{../widgetConfig.year}}}</p>
                  <p class="website"><a href="{{{config.websiteLink}}}" target="_blank"><strong>{{{config.website}}}</strong></a></p>
                </td>
              </tr>
            {{/compare}}

            {{#compare this.type "===" "traffic"}}
              <tr>
                <td class="content -traffic -idx-{{index}}{{#if isFirst}} -first{{/if}}{{#if isLast}} -last{{/if}}" responsive="mobile-padding-horizontal-sides">
                  <p class="title" responsive="mobile-padding-horizontal-sides"><strong>Traffic Highlights</strong></p>
                  <p class="subtitle">Core Traffic Metrics for { {{{../widgetConfig.month}}} }</p>
                  {{#forIn this.config}}
                    {{#compare @key "===" "visits"}}
                      <div class="content-side -visits" responsive="collapse-one mobile-no-padding-horizontal-sides mobile-padding-30-bottom">
                        {{>img
                          src="traffic-icon-01.png"
                          alt="Visits Icon"
                        }}
                        <p class="-visits-count -count"><strong>{{{this}}}</strong></p>
                        <p>Visits</p>
                      </div>
                    {{/compare}}

                    {{#compare @key "===" "pageviews"}}
                      <div class="content-side -pageviews" responsive="collapse-one mobile-no-padding">
                        {{>img
                          src="traffic-icon-02.png"
                          alt="Pageviews Icon"
                        }}
                        <p class="-pageviews-count -count"><strong>{{{this}}}</strong></p>
                        <p>Pageviews</p>
                      </div>
                    {{/compare}}
                  {{/forIn}}
                  <br style="clear:both">
                </td>
              </tr>
            {{/compare}}

            {{#compare this.type "===" "visitors"}}
              <tr>
                <td class="content -visitors -idx-{{index}}{{#if isFirst}} -first{{/if}}{{#if isLast}} -last{{/if}}" responsive="mobile-padding-horizontal-sides mobile-padding-30-bottom">
                  <p class="title" responsive="mobile-padding-horizontal-sides"><strong>How Are Your Visitors Reaching Your Site?</strong></p>
                  <p class="subtitle" responsive="mobile-padding-30-bottom">Breakdown of Visitors by Channel</p>
                  {{#forIn this.config}}
                    {{#compare @key "===" "chart"}}
                      <div class="content-side -chart" responsive="collapse-one mobile-no-padding">
                        {{>img
                          src=this
                          alt="chart Icon"
                        }}
                      </div>
                    {{/compare}}

                    {{#compare @key "===" "items"}}
                      <div class="content-side -items" responsive="collapse-one mobile-no-padding">
                        {{>img
                          src=this
                          alt="items Icon"
                        }}
                      </div>
                    {{/compare}}
                  {{/forIn}}
                  <br style="clear:both">
                </td>
              </tr>
            {{/compare}}

            {{#compare this.type "===" "ad"}}
              <tr>
                <td class="content -ad -idx-{{index}}{{#if isFirst}} -first{{/if}}{{#if isLast}} -last{{/if}}" responsive="mobile-no-padding">
                  <a href="{{{config.link}}}" target="_blank">
                    {{>img
                      src=config.image
                      alt=config.alt
                    }}
                  </a>
                </td>
              </tr>
            {{/compare}}

      {{/table}}
    </td>
  </tr>
          {{/forEach}}
        {{/if}}

  {{#and widgetConfig.background widgetConfig.background.image}}
      </table>
    {{>ui-background backgroundBehavior="cell" backgroundEnd=true}}
  </tr>
  {{/and}}
{{/table}}
