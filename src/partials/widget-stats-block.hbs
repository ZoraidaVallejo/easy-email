{{! ================================================================================================================= }}
{{! W I D G E T   -   A D V E R T I S E M E N T                                                                       }}
{{! ================================================================================================================= }}

{{!
// TODO: Fix anotations.
}}

{{!
 * @param {Object}          widgetConfig
 * @param {string}          widgetConfig.link
 * @param {Object}          widgetConfig.utm
 * @param {Object}          widgetConfig.logo
 * @param {string}          widgetConfig.logo.name
 * @param {string}          widgetConfig.logo.color
 * @param {string}          widgetConfig.title
 * @param {number}          widgetConfig.titleResponsiveSize
 * @param {string}          widgetConfig.image
 * @param {string}          widgetConfig.imageAlt
 * @param {Object}          widgetConfig.background
 * @param {string}          widgetConfig.background.image
 * @param {string}          widgetConfig.background.bgColor
 * @param {number}          widgetConfig.background.width
 * @param {number}          widgetConfig.background.height
 * @param {string}          widgetConfig.background.cssSize
 * @param {Object[]}        widgetConfig.contentOrder
 * @param {string}          widgetConfig.contentOrder[].type
 * @param {string[]|Object} widgetConfig.contentOrder[].config
 * @param {string}          widgetClass
}}

{{assign "adLink" (concat widgetConfig.link (utmVariables widgetConfig.utm))}}
{{assign "adClasses" (classList "widget" "w-advertisement" "-stats-block" widgetClass "set-max-width")}}

{{! ================================================================================================================= }}

{{#table class=(classList "widget" "w-advertisement" "-stats-block" widgetClass "set-max-width")}}

  {{#and widgetConfig.background widgetConfig.background.image}}
    <tr>
      {{>ui-background backgroundBehavior="cell" backgroundStart=true
        bgImage=widgetConfig.background.image
        bgColor=widgetConfig.background.bgColor
        bgWidth=widgetConfig.background.width
        bgHeight=widgetConfig.background.height
        bgSize=widgetConfig.background.cssSize
        bgCellResponsiveClasses=widgetConfig.background.responsive
      }}
        <table {{{tableAttr}}}>
  {{/and}}

  {{#if widgetConfig.logo}}
    <tr>
      {{!
      // TODO: Add modifier classes base on which logo is seleceted.
      }}
      <td class="justia-logo" responsive="mobile-padding-horizontal-sides">
        <a href="{{{@root.adLink}}}" target="_blank">
          {{>img
            src=(get (concat (camelcase widgetConfig.logo.name) ".path." widgetConfig.logo.color) logos)
            alt=(get (concat (camelcase widgetConfig.logo.name) ".alt") logos)
          }}
        </a>
      </td>
    </tr>
  {{/if}}

  {{#if widgetConfig.contentOrder}}
    <tr>
      <td class="content-wrapper" responsive="mobile-padding-horizontal-sides mobile-padding-20-bottom">
        <table {{{tableAttr}}} class="content-wrapper-table">
          {{#if widgetConfig.title}}
            <tr>
              <td class="title" responsive="mobile-padding-horizontal-sides mobile-reset-width">
                <a href="{{{@root.adLink}}}" target="_blank" responsive="mobile-fz-{{default widgetConfig.titleResponsiveSize "24"}}">
                  {{{widgetConfig.title}}}
                </a>
              </td>
            </tr>
          {{/if}}

          <tr>
            <td class="content-border" responsive="mobile-padding-horizontal-sides mobile-padding-20-bottom">
              <table {{{tableAttr}}} class="content-wrapper-inside" responsive="mobile-padding-horizontal-sides mobile-padding-20-bottom">
                {{#forEach widgetConfig.contentOrder}}
                  {{#compare this.type "===" "image-description"}}
                    <tr>
                      <td class="content -image-description -idx-{{index}}{{#if isFirst}} -first{{/if}}{{#if isLast}} -last{{/if}}" responsive="mobile-padding-20-bottom">
                        {{#forIn this.config}}
                          {{#compare @key "===" "image"}}
                            <div class="-image content-side" responsive="collapse-one mobile-no-padding-horizontal-sides mobile-padding-bottom mobile-no-float">
                              <a href="{{{../config.link}}}" target="_blank">
                                {{>img
                                  src=../config.image
                                  alt=(default ../config.subtitle ../config.imageAlt)
                                  responsive="mobile-align-center"
                                }}
                              </a>
                            </div>
                          {{/compare}}
                        {{/forIn}}

                        <div class="-description content-side" responsive="collapse-one mobile-no-padding mobile-no-float mobile-reset-width mobile-align-center">
                          {{#if this.config.name}}
                            <strong class="-name">{{{this.config.name}}}</strong>
                          {{/if}}
                          {{#if this.config.rank}}
                            <div class="-rank">Your Rank for This Leaderboard: {{{this.config.rank}}}</div>
                          {{/if}}
                          {{#if this.config.link}}
                            <a href="{{{this.config.link}}}" target="_blank"><strong>View Profile</strong></a>
                          {{/if}}

                          {{#if this.config.button}}
                            {{#uiButton
                              href=this.config.link
                              presetStyle="justia-blue-ghost"
                              width="210"
                              height="50"
                              fontSize="18"
                              responsive=""
                            }}
                              {{{this.config.button}}}
                            {{/uiButton}}
                          {{/if}}
                        </div>
                      </td>
                    </tr>
                  {{/compare}}
                  {{#compare this.type "===" "profileCompleteness"}}
                    <tr>
                      <td class="content -profile-completeness -idx-{{index}}{{#if isFirst}} -first{{/if}}{{#if isLast}} -last{{/if}}" responsive="mobile-no-padding-bottom mobile-padding-20-top">
                        <strong class="-completeness">Profile Completeness: {{{this.config}}}%</strong>
                        <div class="progress-bar-wrapper">
                          <div class="progress-bar" style="width:{{{this.config}}}%"></div>
                        </div>
                      </td>
                    </tr>
                  {{/compare}}
                {{/forEach}}
                </table>
              </td>
            </tr>
        </table>
      </td>
    </tr>
  {{/if}}

  {{#and widgetConfig.background widgetConfig.background.image}}
      </table>
    {{>ui-background backgroundBehavior="cell" backgroundEnd=true}}
  </tr>
  {{/and}}
{{/table}}
