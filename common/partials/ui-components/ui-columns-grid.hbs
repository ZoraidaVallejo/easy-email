{{! ================================================================================================================= }}
{{! U I   C O L U M N S   G R I D                                                                                     }}
{{! ================================================================================================================= }}

{{!
 * @param {boolean} columnGridStart - Defines the start of the row.
 * @param {boolean} columnGridSeparator - Defines the separators between each cell.
 * @param {boolean} columnGridEnd - Defines the end of the row.
 * @param {number} fullWidth - Sets the full width of the row. Only required when initializing the row.
 * @param {number} totalColumns - Sets how many columns exists on a row. Only required when initializing the row.
 * @param {number} columnsGap - Sets the horizontal gap between each column. Only required when initializing the row.
 * @param {number} rowsGap - Sets the vertical gap between each row. Only required when initializing the row.
 * @param {boolean} [firstRow] - Defines the current row as the first row.
 * @param {boolean} [cellIsEmpty] - Defines if the current cell has no content in it.
 * @param {string} [rowClasses] - Extra classes to add to the current row.
 * @param {string} [cellClasses] - Extra classes to add to the current cell.
}}

{{assign "fullWidth" (default fullWidth @root.fullWidth)}}
{{assign "totalColumns" (default totalColumns @root.totalColumns)}}
{{assign "columnsGap" (default columnsGap @root.columnsGap)}}
{{assign "rowsGap" (default rowsGap @root.rowsGap)}}

{{! Formula for cellWidthMinusGap: ($parent - ($gap * ($columns - 1))) / $columns }}
{{assign
  "cellWidthMinusGap"
  (floor (divide (minus @root.fullWidth (multiply @root.columnsGap (minus @root.totalColumns 1))) @root.totalColumns))
}}

{{assign "rowClasses" (classList "grid-row" rowClasses)}}
{{assign "cellClasses" (classList "grid-cell" cellClasses)}}

{{! ================================================================================================================= }}

{{assign "cellCounter" (ternary @root.cellCounter (add @root.cellCounter 1) 1)}}
{{assign "cellPadding" (concat "padding:" (toPx @root.rowsGap) (toPx @root.columnsGap) "0" "0" separator=" ")}}
{{assign "lastCellPadding" (concat "padding:" (toPx @root.rowsGap) "0" "0" separator=" ")}}

{{#if firstRow}}
  {{assign "cellPadding" (concat "padding:" "0" (toPx @root.columnsGap) "0" "0" separator=" ")}}
  {{assign "lastCellPadding" "padding:0"}}
{{/if}}

{{#if (and firstRow (compare @root.cellCounter "==" 1))}}
  {{assign "cellResponsiveClasses" "collapse-one mobile-no-padding"}}
{{else}}
  {{assign "cellResponsiveClasses" "collapse-one mobile-no-padding-horizontal-sides mobile-padding-30-top"}}
{{/if}}

{{#if cellIsEmpty}}
  {{assign "cellResponsiveClasses" "mobile-hide"}}
{{/if}}

{{assign
  "cellAllAttributes"
  (htmlAttr
    class=@root.cellClasses
    width=@root.cellWidthMinusGap
    style=(ternary (compare @root.totalColumns "==" @root.cellCounter) @root.lastCellPadding @root.cellPadding)
    responsive=@root.cellResponsiveClasses
  )
}}

{{! ================================================================================================================= }}

{{#if columnGridStart}}
  <tr class="{{@root.rowClasses}}">
    <td {{{@root.cellAllAttributes}}} valign="top">
{{/if}}

{{#if columnGridSeparator}}
    </td>
    <td {{{@root.cellAllAttributes}}} valign="top">
{{/if}}

{{#if columnGridEnd}}
    </td>
  </tr>

  {{!-- Reset variables --}}
  {{assign "fullWidth" undefined}}
  {{assign "cellCounter" undefined}}
{{/if}}
